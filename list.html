<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <style>
    body { font-family: sans-serif; padding: 10px; background: #f2f2f2; }
    .container { max-width: 800px; margin: auto; background: white; padding: 15px; border-radius: 8px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { padding: 8px; border: 1px solid #ccc; text-align: center; }
    th { background: #2e86de; color: white; }
    input[type="text"] { width: 100%; padding: 8px; margin-bottom: 10px; }
    button { padding: 5px 10px; margin: 2px; cursor: pointer; border-radius: 4px; border: none; }
    .edit { background: #27ae60; color: white; }
    .delete { background: #c0392b; color: white; }
  </style>
</head>
<body>
<div class="container">
  <h2>üìã ‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶° ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h2>
  <input type="text" id="searchInput" placeholder="‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®...">
  <table>
    <thead>
      <tr>
        <th>‡¶®‡¶æ‡¶Æ</th>
        <th>‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ</th>
        <th>‡¶Æ‡ßã‡¶ü</th>
        <th>‡¶ú‡¶Æ‡¶æ</th>
        <th>‡¶¨‡¶æ‡¶ï‡¶ø</th>
        <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
        <th>‡¶∏‡¶Æ‡ßü</th>
        <th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
      </tr>
    </thead>
    <tbody id="recordTable"></tbody>
  </table>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyASbCt9rJxQbo-tAtDZ_ZjcarnDjHt_kV0",
    authDomain: "money-record-app-b99ac.firebaseapp.com",
    projectId: "money-record-app-b99ac",
    storageBucket: "money-record-app-b99ac.firebasestorage.app",
    messagingSenderId: "1063647502694",
    appId: "1:1063647502694:web:eb6bf014e01143d348a8a7"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const recordTable = document.getElementById("recordTable");
  const searchInput = document.getElementById("searchInput");

  function renderData(doc) {
    const data = doc.data();
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${data.name}</td>
      <td>${data.address}</td>
      <td>${data.amount}</td>
      <td>${data.paid}</td>
      <td>${data.amount - data.paid}</td>
      <td>${data.date}</td>
      <td>${data.time}</td>
      <td>
        <button class="edit" onclick="editRecord('${doc.id}', '${data.name}', '${data.address}', ${data.amount}, ${data.paid}, '${data.date}', '${data.time}')">‚úèÔ∏è</button>
        <button class="delete" onclick="deleteRecord('${doc.id}')">üóëÔ∏è</button>
      </td>
    `;
    recordTable.appendChild(tr);
  }

  function getData() {
    recordTable.innerHTML = "";
    db.collection("records").get().then(snapshot => {
      snapshot.docs.forEach(doc => renderData(doc));
    });
  }

  function deleteRecord(id) {
    if (confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
      db.collection("records").doc(id).delete().then(getData);
    }
  }

  function editRecord(id, name, address, amount, paid, date, time) {
    const newName = prompt("‡¶®‡¶æ‡¶Æ", name);
    const newAddress = prompt("‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ", address);
    const newAmount = prompt("‡¶Æ‡ßã‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ", amount);
    const newPaid = prompt("‡¶ú‡¶Æ‡¶æ ‡¶ü‡¶æ‡¶ï‡¶æ", paid);
    const newDate = prompt("‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ", date);
    const newTime = prompt("‡¶∏‡¶Æ‡ßü", time);

    if (newName && newAddress && newAmount && newPaid && newDate && newTime) {
      db.collection("records").doc(id).update({
        name: newName,
        address: newAddress,
        amount: Number(newAmount),
        paid: Number(newPaid),
        date: newDate,
        time: newTime
      }).then(getData);
    }
  }

  searchInput.addEventListener("input", () => {
    const keyword = searchInput.value.toLowerCase();
    const rows = recordTable.querySelectorAll("tr");
    rows.forEach(row => {
      const name = row.children[0].textContent.toLowerCase();
      row.style.display = name.includes(keyword) ? "" : "none";
    });
  });

  getData();
</script>
</body>
</html>
